{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "KITTYCAD_boundary_representation",
  "type": "object",
  "required": [
    "curves",
    "edges",
    "faces",
    "loops",
    "shells",
    "solids",
    "surfaces",
    "vertices"
  ],
  "properties": {
    "curves": {
      "description": "Curve definitions.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/curve"
      }
    },
    "edges": {
      "description": "Edge definitions.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/edge"
      }
    },
    "faces": {
      "description": "Face definitions.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/face"
      }
    },
    "loops": {
      "description": "Loop definitions.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/loop"
      }
    },
    "shells": {
      "description": "Shell definitions.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/shell"
      }
    },
    "solids": {
      "description": "Solid boundary representation instances.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/solid"
      }
    },
    "surfaces": {
      "description": "Surface definitions.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/surface"
      }
    },
    "vertices": {
      "description": "Vertices in 3D space joining edges.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/vertex"
      }
    }
  },
  "definitions": {
    "curve": {
      "description": "Abstract curve data.",
      "type": "object",
      "oneOf": [
        {
          "description": "Circle curve.",
          "type": "object",
          "required": [
            "circle"
          ],
          "properties": {
            "circle": {
              "$ref": "#/definitions/curve.circle"
            }
          },
          "additionalProperties": false
        },
        {
          "description": "Line curve.",
          "type": "object",
          "required": [
            "line"
          ],
          "properties": {
            "line": {
              "$ref": "#/definitions/curve.line"
            }
          },
          "additionalProperties": false
        },
        {
          "description": "NURBS curve.",
          "type": "object",
          "required": [
            "nurbs"
          ],
          "properties": {
            "nurbs": {
              "$ref": "#/definitions/curve.nurbs"
            }
          },
          "additionalProperties": false
        }
      ],
      "required": [
        "type"
      ],
      "properties": {
        "domain": {
          "description": "Parameter domain.",
          "anyOf": [
            {
              "$ref": "#/definitions/curve.domain"
            },
            {
              "type": "null"
            }
          ]
        },
        "name": {
          "description": "Optional name for this surface.",
          "type": [
            "string",
            "null"
          ]
        },
        "type": {
          "description": "Discriminant.",
          "allOf": [
            {
              "$ref": "#/definitions/curve.type"
            }
          ]
        }
      }
    },
    "curve.circle": {
      "description": "Circular curve definition.\n\nλ(u) := O + R(cos(u)x + sin(u)y), where: * O = `self.origin`, * R = `self.radius`, * x = `self.xbasis`, * y = `self.normal` × `self.xbasis`, * u ∈ {0, 2π}.\n\nThe `xbasis` and `normal` vectors form an orthonormal set.",
      "type": "object",
      "required": [
        "normal",
        "radius",
        "xbasis"
      ],
      "properties": {
        "normal": {
          "description": "Unit vector normal to the plane containing the circle.\n\nThis serves as the Z basis in the parametric co-ordinate space.",
          "type": "array",
          "items": {
            "type": "number",
            "format": "double"
          },
          "maxItems": 3,
          "minItems": 3
        },
        "origin": {
          "description": "Position at the center of the circle.",
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": "number",
            "format": "double"
          },
          "maxItems": 3,
          "minItems": 3
        },
        "radius": {
          "description": "Distance from the center position to all points on the circle.",
          "type": "number",
          "format": "double"
        },
        "xbasis": {
          "description": "Unit vector in the direction from the origin to the point on the circle evaluated at λ(0).\n\nDue to floating point precision, this vector may not lie exactly in the plane. If this is the case then the X vector will be treated as the projection of this vector onto the plane.",
          "type": "array",
          "items": {
            "type": "number",
            "format": "double"
          },
          "maxItems": 3,
          "minItems": 3
        }
      }
    },
    "curve.domain": {
      "description": "Curve parameter domain.",
      "type": "object",
      "required": [
        "max",
        "min"
      ],
      "properties": {
        "max": {
          "description": "Maximum domain value.",
          "type": "number",
          "format": "double"
        },
        "min": {
          "description": "Minimum domain value.",
          "type": "number",
          "format": "double"
        }
      }
    },
    "curve.line": {
      "description": "Line curve definition.\n\nEither end or direction must be set.",
      "type": "object",
      "required": [
        "start"
      ],
      "properties": {
        "direction": {
          "description": "Unit vector pointing away from the origin position.",
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": "number",
            "format": "double"
          },
          "maxItems": 3,
          "minItems": 3
        },
        "end": {
          "description": "End position.",
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": "number",
            "format": "double"
          },
          "maxItems": 3,
          "minItems": 3
        },
        "start": {
          "description": "Origin position.",
          "type": "array",
          "items": {
            "type": "number",
            "format": "double"
          },
          "maxItems": 3,
          "minItems": 3
        }
      }
    },
    "curve.nurbs": {
      "description": "NURBS curve definition.",
      "type": "object",
      "required": [
        "controlPoints",
        "knotVector",
        "order"
      ],
      "properties": {
        "controlPoints": {
          "description": "Array of control vertices.",
          "type": "array",
          "items": {
            "type": "array",
            "items": {
              "type": "number",
              "format": "double"
            },
            "maxItems": 4,
            "minItems": 4
          }
        },
        "knotVector": {
          "description": "Knot vector.",
          "type": "array",
          "items": {
            "type": "number",
            "format": "double"
          }
        },
        "order": {
          "description": "Order of basis splines.",
          "type": "integer",
          "format": "uint32",
          "minimum": 0.0
        }
      }
    },
    "curve.type": {
      "description": "Discriminant for `Curve` data.",
      "oneOf": [
        {
          "description": "Circular curve.",
          "type": "string",
          "enum": [
            "Circle"
          ]
        },
        {
          "description": "Line curve.",
          "type": "string",
          "enum": [
            "Line"
          ]
        },
        {
          "description": "NURBS curve.",
          "type": "string",
          "enum": [
            "Nurbs"
          ]
        }
      ]
    },
    "edge": {
      "description": "Pair of vertices on a face plus an optional trim domain.",
      "type": "object",
      "required": [
        "closed",
        "curve"
      ],
      "properties": {
        "closed": {
          "description": "Marker for a closed edge.",
          "type": "boolean"
        },
        "curve": {
          "description": "The edge curve geometry in 3D (or homogeneous 4D) space.",
          "allOf": [
            {
              "$ref": "#/definitions/indexWithOrientation"
            }
          ]
        },
        "end": {
          "description": "Edge end vertex.",
          "anyOf": [
            {
              "$ref": "#/definitions/index"
            },
            {
              "type": "null"
            }
          ]
        },
        "start": {
          "description": "Edge start vertex.",
          "anyOf": [
            {
              "$ref": "#/definitions/index"
            },
            {
              "type": "null"
            }
          ]
        },
        "subdomain": {
          "description": "Optional domain to select a subset of the edge curve geometry.\n\nWhen `None`, the domain is the same as the edge curve geometry domain.",
          "anyOf": [
            {
              "$ref": "#/definitions/curve.domain"
            },
            {
              "type": "null"
            }
          ]
        }
      }
    },
    "face": {
      "description": "Set of loops defined on an abstract surface.",
      "type": "object",
      "required": [
        "surface"
      ],
      "properties": {
        "loops": {
          "description": "Face bounds.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/indexWithOrientation"
          }
        },
        "surface": {
          "description": "Surface the face edges and vertices reside on.",
          "allOf": [
            {
              "$ref": "#/definitions/indexWithOrientation"
            }
          ]
        }
      }
    },
    "index": {
      "type": "integer",
      "format": "uint32",
      "minimum": 0.0
    },
    "indexWithOrientation": {
      "type": "array",
      "items": [
        {
          "type": "integer",
          "format": "uint32",
          "minimum": 0.0
        },
        {
          "$ref": "#/definitions/orientation"
        }
      ],
      "maxItems": 2,
      "minItems": 2
    },
    "loop": {
      "description": "Edge loop.",
      "type": "object",
      "required": [
        "edges"
      ],
      "properties": {
        "edges": {
          "description": "Oriented edges forming the loop.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/indexWithOrientation"
          }
        },
        "uvCurves": {
          "description": "Optional 1:1 pairing of UV curves to edges.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/indexWithOrientation"
          }
        }
      }
    },
    "orientation": {
      "description": "Selected orientation of an orientable item.",
      "oneOf": [
        {
          "description": "Same-sense orientation.",
          "type": "string",
          "enum": [
            "Same"
          ]
        },
        {
          "description": "Reverse-sense orientation.",
          "type": "string",
          "enum": [
            "Reverse"
          ]
        }
      ]
    },
    "shell": {
      "description": "Boundary representation volume.",
      "type": "object",
      "required": [
        "faces"
      ],
      "properties": {
        "faces": {
          "description": "Set of connected faces forming a closed 'watertight' volume.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/indexWithOrientation"
          }
        },
        "name": {
          "description": "Optional name for this shell.",
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "solid": {
      "description": "Solid boundary representation structure.",
      "type": "object",
      "required": [
        "shells"
      ],
      "properties": {
        "mesh": {
          "description": "Optional mesh approximation of this solid.",
          "anyOf": [
            {
              "$ref": "#/definitions/index"
            },
            {
              "type": "null"
            }
          ]
        },
        "name": {
          "description": "Optional name for this solid.",
          "type": [
            "string",
            "null"
          ]
        },
        "shells": {
          "description": "The boundaries of the solid volume.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/indexWithOrientation"
          }
        }
      }
    },
    "surface": {
      "description": "Abstract surface data.",
      "type": "object",
      "oneOf": [
        {
          "description": "Cylindrical surface.",
          "type": "object",
          "required": [
            "cylinder"
          ],
          "properties": {
            "cylinder": {
              "$ref": "#/definitions/surface.cylinder"
            }
          },
          "additionalProperties": false
        },
        {
          "description": "NURBS surface.",
          "type": "object",
          "required": [
            "nurbs"
          ],
          "properties": {
            "nurbs": {
              "$ref": "#/definitions/surface.nurbs"
            }
          },
          "additionalProperties": false
        },
        {
          "description": "Planar surface.",
          "type": "object",
          "required": [
            "plane"
          ],
          "properties": {
            "plane": {
              "$ref": "#/definitions/surface.plane"
            }
          },
          "additionalProperties": false
        },
        {
          "description": "Spherical surface.",
          "type": "object",
          "required": [
            "sphere"
          ],
          "properties": {
            "sphere": {
              "$ref": "#/definitions/surface.sphere"
            }
          },
          "additionalProperties": false
        },
        {
          "description": "Toroidal surface.",
          "type": "object",
          "required": [
            "torus"
          ],
          "properties": {
            "torus": {
              "$ref": "#/definitions/surface.torus"
            }
          },
          "additionalProperties": false
        }
      ],
      "required": [
        "type"
      ],
      "properties": {
        "domain": {
          "description": "Surface parameter domain.",
          "anyOf": [
            {
              "$ref": "#/definitions/surface.domain"
            },
            {
              "type": "null"
            }
          ]
        },
        "name": {
          "description": "Optional name for this surface.",
          "type": [
            "string",
            "null"
          ]
        },
        "type": {
          "description": "Discriminant.",
          "allOf": [
            {
              "$ref": "#/definitions/surface.type"
            }
          ]
        }
      }
    },
    "surface.cylinder": {
      "description": "Parametric cylindrical surface definition.\n\nσ(u, v) := O + R(cos(u)x + sin(u)y) + vz, where: * O = `self.circle.origin`, * R = `self.circle.radius`, * x = `self.circle.xbasis`, * y = `self.circle.normal` × `self.circle.xbasis`, * z = `self.circle.normal`, * h = `self.height`, * u ∈ {0, 2π}, * v ∈ {0, h}.\n\nCylinders are defined in reference to a circle that is extruded along the circle normal vector.",
      "type": "object",
      "required": [
        "circle",
        "height"
      ],
      "properties": {
        "circle": {
          "description": "The extruded circle.",
          "allOf": [
            {
              "$ref": "#/definitions/curve.circle"
            }
          ]
        },
        "height": {
          "description": "Height of the extruded circle.",
          "type": "number",
          "format": "double"
        }
      }
    },
    "surface.domain": {
      "description": "Domain of surface parameters.",
      "type": "object",
      "required": [
        "max",
        "min"
      ],
      "properties": {
        "max": {
          "description": "Maximum domain values.",
          "type": "array",
          "items": {
            "type": "number",
            "format": "double"
          },
          "maxItems": 2,
          "minItems": 2
        },
        "min": {
          "description": "Minimum domain values.",
          "type": "array",
          "items": {
            "type": "number",
            "format": "double"
          },
          "maxItems": 2,
          "minItems": 2
        }
      }
    },
    "surface.nurbs": {
      "description": "NURBS surface definition.",
      "type": "object",
      "required": [
        "controlPoints",
        "knotVector",
        "numControlPoints",
        "numKnots",
        "order"
      ],
      "properties": {
        "controlPoints": {
          "description": "Matrix of control point vertices.",
          "type": "array",
          "items": {
            "type": "array",
            "items": {
              "type": "number",
              "format": "double"
            },
            "maxItems": 4,
            "minItems": 4
          }
        },
        "knotVector": {
          "description": "Knot vector.",
          "type": "array",
          "items": {
            "type": "number",
            "format": "double"
          }
        },
        "numControlPoints": {
          "description": "Dimensions of control point vertex matrix.",
          "type": "array",
          "items": {
            "type": "integer",
            "format": "uint32",
            "minimum": 0.0
          },
          "maxItems": 2,
          "minItems": 2
        },
        "numKnots": {
          "description": "Number of knots in U and V.",
          "type": "array",
          "items": {
            "type": "integer",
            "format": "uint32",
            "minimum": 0.0
          },
          "maxItems": 2,
          "minItems": 2
        },
        "order": {
          "description": "Order of basis splines.",
          "type": "array",
          "items": {
            "type": "integer",
            "format": "uint32",
            "minimum": 0.0
          },
          "maxItems": 2,
          "minItems": 2
        }
      }
    },
    "surface.plane": {
      "description": "Plane surface definition.",
      "type": "object",
      "required": [
        "normal"
      ],
      "properties": {
        "constant": {
          "description": "The value of `d` in the plane equation `n.r = d`.",
          "type": [
            "number",
            "null"
          ],
          "format": "double"
        },
        "normal": {
          "description": "Normal vector to the plane.",
          "type": "array",
          "items": {
            "type": "number",
            "format": "double"
          },
          "maxItems": 3,
          "minItems": 3
        },
        "point": {
          "description": "An arbitrary point that lies on the plane.",
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": "number",
            "format": "double"
          },
          "maxItems": 3,
          "minItems": 3
        }
      }
    },
    "surface.sphere": {
      "description": "Parametric spherical surface definition.\n\nσ(u, v) := O + Rcos(v)(cos(u)x + sin(u)y) + Rsin(v)z, where: * O = `self.horizon.origin`, * R = `self.horizon.radius`, * x = `self.horizon.xbasis`, * y = `self.horizon.normal` × `self.horizon.xbasis`, * z = `self.horizon.normal`, * u ∈ {0, 2π}, * v ∈ {0, 2π}.\n\nSpheres are defined in reference to a circle at zero inclination.",
      "type": "object",
      "required": [
        "horizon"
      ],
      "properties": {
        "horizon": {
          "description": "The circle at zero inclination.",
          "allOf": [
            {
              "$ref": "#/definitions/curve.circle"
            }
          ]
        }
      }
    },
    "surface.torus": {
      "description": "Toroidal surface definition.\n\nσ(u, v) := O + (R + rcos(v))(cos(u)x + sin(u)y) + rsin(v)z, where: * O = `self.origin`, * R = `self.radius`, * r = `self.circle.radius`, * x = `self.circle.xbasis`, * y = `self.circle.normal` × `self.circle.xbasis`, * z = `self.circle.normal`, * u, v ∈ {0, 2π}.\n\nTori are defined in reference to a circle that is revolved about an origin at a specified distance. This distance is called the major radius. The radius of the circle of revolution is called the minor radius.",
      "type": "object",
      "required": [
        "circle",
        "origin",
        "radius"
      ],
      "properties": {
        "circle": {
          "description": "Circle of revolution.",
          "allOf": [
            {
              "$ref": "#/definitions/curve.circle"
            }
          ]
        },
        "origin": {
          "description": "The center of the torus.\n\nThe axis of revolution passes through the origin of the torus.",
          "type": "array",
          "items": {
            "type": "number",
            "format": "double"
          },
          "maxItems": 3,
          "minItems": 3
        },
        "radius": {
          "description": "Distance from the torus origin to the origin of the revolved circle.",
          "type": "number",
          "format": "double"
        }
      }
    },
    "surface.type": {
      "description": "Discriminant for `Surface` data.",
      "oneOf": [
        {
          "description": "Cylindrical surface.",
          "type": "string",
          "enum": [
            "Cylinder"
          ]
        },
        {
          "description": "NURBS surface.",
          "type": "string",
          "enum": [
            "Nurbs"
          ]
        },
        {
          "description": "Planar surface.",
          "type": "string",
          "enum": [
            "Plane"
          ]
        },
        {
          "description": "Spherical surface.",
          "type": "string",
          "enum": [
            "Sphere"
          ]
        },
        {
          "description": "Torus surface.",
          "type": "string",
          "enum": [
            "Torus"
          ]
        }
      ]
    },
    "vertex": {
      "description": "Junctions of edges in 3D space.",
      "type": "array",
      "items": {
        "type": "number",
        "format": "double"
      },
      "maxItems": 3,
      "minItems": 3
    }
  }
}
